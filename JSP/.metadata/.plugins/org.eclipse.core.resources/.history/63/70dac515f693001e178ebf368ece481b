<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ page import="javax.xml.parsers.*" %>
<%@ page import="org.w3c.dom.*" %>
<%@ page import="org.xml.sax.InputSource" %>
<%@ page import="java.io.StringReader" %>
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/css/bootstrap.min.css">
    <title>ðŸ”¥CampingðŸ”¥</title>
</head>
<body>
<h2>XXE Vulnerability Example</h2>
<%
    String xmlData = request.getParameter("xmlData");
    if (xmlData != null && !xmlData.isEmpty()) {
        try {
            DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
            // ì£¼ì˜: XXE ì·¨ì•½ì  ë°œìƒì„ ìœ„í•´ ì™¸ë¶€ ì—”í‹°í‹° ì²˜ë¦¬ í™œì„±í™”
            factory.setFeature("http://apache.org/xml/features/disallow-doctype-decl", false);
            factory.setFeature("http://xml.org/sax/features/external-general-entities", true);
            factory.setFeature("http://xml.org/sax/features/external-parameter-entities", true);
            DocumentBuilder builder = factory.newDocumentBuilder();
            InputSource is = new InputSource(new StringReader(xmlData));
            Document doc = builder.parse(is);
            doc.getDocumentElement().normalize();

            // ê°„ë‹¨í•œ XML íŒŒì‹± ì˜ˆì œ
            out.println("<h3>Received XML Data:</h3>");
            out.println("<p>" + doc.getDocumentElement().getTextContent() + "</p>");
        } catch (Exception e) {
            out.println("<p>Error: " + e.getMessage() + "</p>");
        }
    }
%>
<form method="post">
    <textarea name="xmlData" rows="10" cols="30"></textarea><br>
    <input type="submit" value="Submit XML Data">
</form>
</body>
</html>